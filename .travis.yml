dist: trusty
sudo: required
language: clojure

cache:
  directories:
    - $HOME/.m2

before_script:
  # update lein to latest, https://github.com/technomancy/leiningen/issues/2014#issuecomment-153829977
  - yes y | sudo lein upgrade
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - sudo add-apt-repository -y ppa:mfikes/planck
  - sudo apt-get -qq update
  - sudo apt-get install -y planck
  - nvm install node
  - nvm use node
  #- npm install -g lumo-cljs
  - mkdir -p lumo && cd lumo && wget -O lumo.zip http://s3.amazonaws.com/lumo-linux/lumo.zip && unzip lumo.zip && cd ..
  - sudo ln -s `pwd`/lumo/lumo /usr/local/bin/lumo
  - git clone -b patched https://github.com/darwin/tach.git
  - cd tach && lein install && cd ..  # patch tach for now

script: lein test-all
